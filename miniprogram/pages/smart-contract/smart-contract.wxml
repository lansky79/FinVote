<!-- pages/smart-contract/smart-contract.wxml -->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="page-title">æ™ºèƒ½åˆçº¦</text>
    <text class="page-desc">åˆ›å»ºå’Œç®¡ç†æ‚¨çš„æ™ºèƒ½åˆçº¦</text>
  </view>

  <!-- æ ‡ç­¾åˆ‡æ¢ -->
  <view class="tab-bar">
    <view 
      class="tab-item {{activeTab === 'my' ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-tab="my"
    >
      <text>æˆ‘çš„åˆçº¦</text>
    </view>
    <view 
      class="tab-item {{activeTab === 'market' ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-tab="market"
    >
      <text>åˆçº¦å¸‚åœº</text>
    </view>
  </view>

  <!-- åˆ›å»ºåˆçº¦æŒ‰é’® -->
  <view class="create-section" wx:if="{{activeTab === 'my'}}">
    <button class="btn-primary create-btn" bindtap="createContract">
      <text class="btn-icon">â•</text>
      <text>åˆ›å»ºæ™ºèƒ½åˆçº¦</text>
    </button>
  </view>

  <!-- åˆçº¦ç±»å‹ä»‹ç» -->
  <view class="contract-types" wx:if="{{activeTab === 'my' && contracts.length === 0}}">
    <view class="types-title">æ”¯æŒçš„åˆçº¦ç±»å‹</view>
    <view class="type-list">
      <view class="type-item card" wx:for="{{contractTypes}}" wx:key="id">
        <view class="type-header">
          <text class="type-name">{{item.name}}</text>
        </view>
        <text class="type-desc">{{item.desc}}</text>
      </view>
    </view>
  </view>

  <!-- åˆçº¦åˆ—è¡¨ -->
  <view class="contract-list" wx:if="{{!loading}}">
    <view class="contract-item card" wx:for="{{contracts}}" wx:key="id">
      <view class="contract-header">
        <view class="contract-info">
          <text class="contract-name">{{item.name}}</text>
          <text class="contract-type">{{item.typeName}}</text>
        </view>
        <view class="contract-status">
          <text class="status-badge {{item.status}}">{{item.statusText}}</text>
        </view>
      </view>

      <view class="contract-desc">
        <text>{{item.description}}</text>
      </view>

      <view class="contract-meta">
        <text class="meta-item">åˆ›å»ºæ—¶é—´: {{item.createTimeText}}</text>
        <text class="meta-item" wx:if="{{item.gasUsed}}">Gasæ¶ˆè€—: {{item.gasUsed}}</text>
      </view>

      <view class="contract-actions">
        <button class="btn-outline" bindtap="viewContract" data-id="{{item.id}}">
          æŸ¥çœ‹è¯¦æƒ…
        </button>
        
        <button 
          class="btn-primary" 
          wx:if="{{item.status === 'draft'}}"
          bindtap="deployContract" 
          data-id="{{item.id}}"
        >
          éƒ¨ç½²åˆçº¦
        </button>
        
        <button 
          class="btn-success" 
          wx:if="{{item.status === 'deployed'}}"
          bindtap="executeContract" 
          data-id="{{item.id}}"
        >
          æ‰§è¡Œåˆçº¦
        </button>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!loading && contracts.length === 0}}">
    <text class="empty-icon">ğŸ“œ</text>
    <text class="empty-text">
      {{activeTab === 'my' ? 'æ‚¨è¿˜æ²¡æœ‰åˆ›å»ºä»»ä½•åˆçº¦' : 'æš‚æ— å¯ç”¨çš„åˆçº¦'}}
    </text>
    <text class="empty-desc">
      {{activeTab === 'my' ? 'ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªæ™ºèƒ½åˆçº¦' : 'è¯·ç¨åå†æ¥æŸ¥çœ‹'}}
    </text>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view class="loading" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>
</view>