<!-- pages/create-vote/create-vote.wxml -->
<view class="container">
  <form bindsubmit="handleSubmit">
    <view class="form-section card">
      <view class="section-title">åŸºæœ¬ä¿¡æ¯</view>
      
      <view class="form-item">
        <text class="label">æŠ•ç¥¨æ ‡é¢˜ *</text>
        <input 
          class="input" 
          name="title"
          placeholder="è¯·è¾“å…¥æŠ•ç¥¨æ ‡é¢˜"
          value="{{formData.title}}"
          bindinput="handleInput"
          data-field="title"
        />
      </view>

      <view class="form-item">
        <text class="label">æŠ•ç¥¨æè¿°</text>
        <textarea 
          class="textarea" 
          name="description"
          placeholder="è¯·è¾“å…¥æŠ•ç¥¨æè¿°ï¼ˆå¯é€‰ï¼‰"
          value="{{formData.description}}"
          bindinput="handleInput"
          data-field="description"
          maxlength="200"
        ></textarea>
      </view>
    </view>

    <view class="form-section card">
      <view class="section-title">æŠ•ç¥¨æ ‡çš„</view>
      
      <view class="form-item">
        <text class="label">æ ‡çš„ç±»å‹</text>
        <picker 
          range="{{voteTypes}}" 
          range-key="name"
          value="{{voteTypeIndex}}"
          bindchange="handleVoteTypeChange"
        >
          <view class="picker">
            {{voteTypes[voteTypeIndex].name}}
            <text class="picker-arrow">></text>
          </view>
        </picker>
      </view>

      <view class="form-item">
        <text class="label">{{voteTypes[voteTypeIndex].value === 'stock' ? 'è‚¡ç¥¨ä»£ç ' : 'æŒ‡æ•°ä»£ç '}} *</text>
        <view class="stock-input-wrapper">
          <input 
            class="input stock-input" 
            name="stockCode"
            placeholder="{{voteTypes[voteTypeIndex].value === 'stock' ? 'å¦‚ï¼š000001' : 'å¦‚ï¼š000001.SH'}}"
            value="{{formData.stockCode}}"
            bindinput="handleInput"
            data-field="stockCode"
          />
          <button 
            class="btn-search" 
            type="button"
            bindtap="searchStock"
            disabled="{{!formData.stockCode}}"
          >
            æœç´¢
          </button>
        </view>
      </view>

      <view class="form-item" wx:if="{{stockInfo.name}}">
        <text class="label">æ ‡çš„åç§°</text>
        <view class="stock-info">
          <text class="stock-name">{{stockInfo.name}}</text>
          <text class="stock-price text-{{stockInfo.change >= 0 ? 'success' : 'danger'}}">
            Â¥{{stockInfo.price}} ({{stockInfo.change >= 0 ? '+' : ''}}{{stockInfo.changePercent}}%)
          </text>
        </view>
      </view>
    </view>

    <view class="form-section card">
      <view class="section-title">æ—¶é—´è®¾ç½®</view>
      
      <view class="form-item">
        <text class="label">æŠ•ç¥¨æˆªæ­¢æ—¶é—´ *</text>
        <view class="datetime-picker">
          <picker 
            mode="date" 
            value="{{formData.endDate}}"
            start="{{today}}"
            bindchange="handleDateChange"
            data-field="endDate"
          >
            <view class="picker">{{formData.endDate || 'é€‰æ‹©æ—¥æœŸ'}}</view>
          </picker>
          <picker 
            mode="time" 
            value="{{formData.endTime}}"
            bindchange="handleTimeChange"
            data-field="endTime"
          >
            <view class="picker">{{formData.endTime || 'é€‰æ‹©æ—¶é—´'}}</view>
          </picker>
        </view>
      </view>

      <view class="form-item">
        <text class="label">ç»“ç®—æ—¶é—´ *</text>
        <view class="datetime-picker">
          <picker 
            mode="date" 
            value="{{formData.settlementDate}}"
            start="{{formData.endDate || today}}"
            bindchange="handleDateChange"
            data-field="settlementDate"
          >
            <view class="picker">{{formData.settlementDate || 'é€‰æ‹©æ—¥æœŸ'}}</view>
          </picker>
          <picker 
            mode="time" 
            value="{{formData.settlementTime}}"
            bindchange="handleTimeChange"
            data-field="settlementTime"
          >
            <view class="picker">{{formData.settlementTime || 'é€‰æ‹©æ—¶é—´'}}</view>
          </picker>
        </view>
      </view>

      <view class="time-tips">
        <text class="tips-text">ğŸ’¡ ç»“ç®—æ—¶é—´ç”¨äºè·å–æœ€ç»ˆä»·æ ¼ï¼Œå»ºè®®è®¾ç½®åœ¨äº¤æ˜“æ—¶é—´å†…</text>
      </view>
    </view>

    <view class="form-section card">
      <view class="section-title">å¥–åŠ±è®¾ç½®</view>
      
      <view class="form-item">
        <text class="label">é¢„æµ‹æ­£ç¡®å¥–åŠ±ç§¯åˆ†</text>
        <picker 
          range="{{pointsOptions}}" 
          value="{{pointsIndex}}"
          bindchange="handlePointsChange"
        >
          <view class="picker">
            {{pointsOptions[pointsIndex]}} ç§¯åˆ†
            <text class="picker-arrow">></text>
          </view>
        </picker>
      </view>
    </view>

    <view class="form-actions">
      <button 
        class="btn-primary submit-btn" 
        formType="submit"
        disabled="{{!canSubmit}}"
      >
        åˆ›å»ºæŠ•ç¥¨
      </button>
    </view>
  </form>
</view>