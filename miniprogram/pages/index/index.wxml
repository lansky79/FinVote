<!-- pages/index/index.wxml -->
<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="card user-info" wx:if="{{userInfo}}">
    <view class="flex-between">
      <view class="flex">
        <image class="avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
        <view class="user-details">
          <text class="username">{{userInfo.nickName}}</text>
          <text class="points text-primary">ç§¯åˆ†: {{userInfo.points || 0}}</text>
        </view>
      </view>
      <view class="rank-info">
        <text class="rank-text">æ’å: {{userInfo.rank || '-'}}</text>
      </view>
    </view>
  </view>

  <!-- ç™»å½•æç¤º -->
  <view class="card login-prompt" wx:if="{{!userInfo}}">
    <view class="flex-center flex-column">
      <text class="login-title">æ¬¢è¿æ¥åˆ°è‚¡ç¥¨æŠ•ç¥¨</text>
      <text class="login-desc text-muted">ç™»å½•åå¼€å§‹é¢„æµ‹è‚¡ç¥¨æ¶¨è·Œï¼Œèµ¢å–ç§¯åˆ†</text>
      <button class="btn-primary mt-20" bindtap="handleLogin">å¾®ä¿¡ç™»å½•</button>
    </view>
  </view>

  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="stats-grid">
    <view class="stat-item card">
      <text class="stat-number text-primary">{{stats.totalVotes || 0}}</text>
      <text class="stat-label">æ€»æŠ•ç¥¨æ•°</text>
    </view>
    <view class="stat-item card">
      <text class="stat-number text-success">{{stats.correctVotes || 0}}</text>
      <text class="stat-label">é¢„æµ‹æ­£ç¡®</text>
    </view>
    <view class="stat-item card">
      <text class="stat-number">{{stats.accuracy || '0%'}}</text>
      <text class="stat-label">å‡†ç¡®ç‡</text>
    </view>
  </view>

  <!-- çƒ­é—¨æŠ•ç¥¨ -->
  <view class="section">
    <view class="section-header flex-between">
      <text class="section-title">çƒ­é—¨æŠ•ç¥¨</text>
      <text class="more-link text-primary" bindtap="goToVote">æŸ¥çœ‹æ›´å¤š</text>
    </view>
    
    <view class="vote-list">
      <view class="vote-item card" wx:for="{{hotVotes}}" wx:key="id" bindtap="goToVoteDetail" data-id="{{item.id}}">
        <view class="vote-header flex-between">
          <text class="vote-title">{{item.title}}</text>
          <text class="vote-status {{item.status === 'active' ? 'text-success' : 'text-muted'}}">
            {{item.status === 'active' ? 'è¿›è¡Œä¸­' : 'å·²ç»“æŸ'}}
          </text>
        </view>
        <view class="vote-info">
          <text class="stock-code text-primary">{{item.stockCode}}</text>
          <text class="vote-time text-muted">{{item.endTime}}</text>
        </view>
        <view class="vote-stats flex-between mt-20">
          <text class="participants text-muted">{{item.participants}}äººå‚ä¸</text>
          <view class="vote-options">
            <text class="option-up text-success">çœ‹æ¶¨ {{item.upVotes}}</text>
            <text class="option-down text-danger ml-20">çœ‹è·Œ {{item.downVotes}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å¿«é€Ÿæ“ä½œ -->
  <view class="quick-actions">
    <button class="btn-primary action-btn" bindtap="goToCreateVote">
      <text>åˆ›å»ºæŠ•ç¥¨</text>
    </button>
    <button class="btn-secondary action-btn" bindtap="goToBlockchainDemo">
      <text>ğŸ”— åŒºå—é“¾æ¼”ç¤º</text>
    </button>
    <button class="btn-secondary action-btn" bindtap="goToShop">
      <text>ç§¯åˆ†å•†åŸ</text>
    </button>
  </view>
</view>