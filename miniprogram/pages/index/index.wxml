<!-- pages/index/index.wxml -->
<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="card user-info" wx:if="{{userInfo}}">
    <view class="flex-between">
      <view class="flex">
        <image class="avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
        <view class="user-details">
          <text class="username">{{userInfo.nickName}}</text>
          <text class="points">ç§¯åˆ†: {{userInfo.points || 0}}</text>
        </view>
      </view>
      <view class="rank-info">
        <text class="rank-text">æ’å: {{userInfo.rank || '-'}}</text>
      </view>
    </view>
  </view>

  <!-- ç™»å½•æç¤º -->
  <view class="card login-prompt" wx:if="{{!userInfo}}">
    <view class="flex-center flex-column">
      <text class="login-title">æ¬¢è¿æ¥åˆ°è‚¡ç¥¨æŠ•ç¥¨</text>
      <text class="login-desc text-muted">ç™»å½•åå¼€å§‹é¢„æµ‹è‚¡ç¥¨æ¶¨è·Œï¼Œèµ¢å–ç§¯åˆ†</text>
      <button class="btn-primary" bindtap="handleLogin">å¾®ä¿¡ç™»å½•</button>
    </view>
  </view>

  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="stats-grid">
    <view class="stat-item card">
      <text class="stat-number text-primary">{{stats.totalVotes || 0}}</text>
      <text class="stat-label">æ€»æŠ•ç¥¨</text>
    </view>
    <view class="stat-item card">
      <text class="stat-number text-success">{{stats.correctVotes || 0}}</text>
      <text class="stat-label">é¢„æµ‹æ­£ç¡®</text>
    </view>
    <view class="stat-item card">
      <text class="stat-number">{{stats.accuracy || '0%'}}</text>
      <text class="stat-label">å‡†ç¡®ç‡</text>
    </view>
  </view>

  <!-- çƒ­é—¨æŠ•ç¥¨ - ç´§å‡‘æ˜¾ç¤º -->
  <view class="section">
    <view class="section-header flex-between">
      <text class="section-title">çƒ­é—¨æŠ•ç¥¨</text>
      <text class="more-link text-primary" bindtap="goToVote">æ›´å¤š</text>
    </view>
    
    <view class="vote-list">
      <view class="vote-item-compact card" wx:for="{{hotVotes}}" wx:key="id" wx:if="{{index < 2}}" bindtap="goToVoteDetail" data-id="{{item.id}}">
        <view class="vote-compact-header">
          <text class="vote-compact-title">{{item.title}}</text>
          <text class="vote-status {{item.status === 'active' ? 'text-success' : 'text-muted'}}">
            {{item.status === 'active' ? 'è¿›è¡Œä¸­' : 'å·²ç»“æŸ'}}
          </text>
        </view>
        <view class="vote-compact-info">
          <text class="stock-code text-primary">{{item.stockCode}}</text>
          <text class="vote-status-text {{item.userVoted ? 'text-success' : 'text-primary'}}">
            {{item.userVoted ? 'å·²æŠ•ç¥¨' : 'å¯æŠ•ç¥¨'}}
          </text>
        </view>
      </view>
      
      <!-- æ— æ•°æ®æç¤º -->
      <view class="no-data card" wx:if="{{hotVotes.length === 0}}">
        <text class="no-data-text text-muted">æš‚æ— çƒ­é—¨æŠ•ç¥¨</text>
      </view>
    </view>
  </view>

  <!-- å¿«é€Ÿæ“ä½œ - ç½‘æ ¼å¸ƒå±€ -->
  <view class="quick-actions-grid">
    <button class="action-btn-grid btn-primary" bindtap="goToCreateVote">
      <text class="action-icon">ğŸ“Š</text>
      <text class="action-text">åˆ›å»ºæŠ•ç¥¨</text>
    </button>
    <button class="action-btn-grid btn-secondary" bindtap="goToVote">
      <text class="action-icon">ğŸ“ˆ</text>
      <text class="action-text">æŠ•ç¥¨å¤§å…</text>
    </button>
    <button class="action-btn-grid btn-secondary" bindtap="goToLottery">
      <text class="action-icon">ğŸ°</text>
      <text class="action-text">è½¬ç›˜æŠ½å¥–</text>
    </button>
    <button class="action-btn-grid btn-secondary" bindtap="goToShop">
      <text class="action-icon">ğŸ›’</text>
      <text class="action-text">ç§¯åˆ†å•†åŸ</text>
    </button>
    <button class="action-btn-grid btn-secondary" bindtap="goToSmartContract">
      <text class="action-icon">ğŸ“œ</text>
      <text class="action-text">æ™ºèƒ½åˆçº¦</text>
    </button>
    <button class="action-btn-grid btn-secondary" bindtap="goToBlockchainDemo">
      <text class="action-icon">ğŸ”—</text>
      <text class="action-text">åŒºå—é“¾</text>
    </button>
  </view>
</view>