<!-- pages/lottery/lottery.wxml -->
<view class="container">
  <!-- 用户积分信息 -->
  <view class="card points-info">
    <view class="points-header">
      <text class="points-title">我的积分</text>
      <text class="points-value">{{userPoints}}</text>
    </view>
    <view class="cost-info">
      <text class="cost-text">每次抽奖消耗 {{costPoints}} 积分</text>
    </view>
  </view>

  <!-- 转盘容器 -->
  <view class="lottery-container">
    <view class="wheel-container">
      <!-- 转盘 -->
      <view class="wheel" style="transform: rotate({{spinAngle}}deg);">
        <view 
          class="sector" 
          wx:for="{{prizes}}" 
          wx:key="id"
          style="transform: rotate({{index * 60}}deg); background-color: {{item.color}};"
        >
          <view class="sector-content">
            <text class="prize-name">{{item.name}}</text>
          </view>
        </view>
      </view>
      
      <!-- 指针 -->
      <view class="pointer"></view>
      
      <!-- 中心按钮 -->
      <view class="center-btn {{isSpinning ? 'spinning' : ''}}" bindtap="startSpin">
        <text class="btn-text">{{isSpinning ? '抽奖中...' : '开始抽奖'}}</text>
      </view>
    </view>
  </view>

  <!-- 抽奖说明 -->
  <view class="card lottery-rules">
    <view class="rules-title">抽奖规则</view>
    <view class="rules-list">
      <text class="rule-item">• 每次抽奖消耗 {{costPoints}} 积分</text>
      <text class="rule-item">• 奖品包含 10-500 积分不等</text>
      <text class="rule-item">• 通过投票预测可获得积分</text>
      <text class="rule-item">• 积分可在商城兑换奖品</text>
    </view>
  </view>

  <!-- 操作按钮 -->
  <view class="action-buttons">
    <button class="btn-secondary" bindtap="viewHistory">抽奖记录</button>
  </view>
</view>

<!-- 结果弹窗 -->
<view class="result-modal" wx:if="{{showResult}}">
  <view class="modal-content">
    <view class="result-header">
      <text class="congrats-text">🎉 恭喜获得</text>
    </view>
    <view class="result-prize">
      <text class="prize-text">{{result.name}}</text>
    </view>
    <view class="result-footer">
      <text class="current-points">当前积分：{{userPoints}}</text>
    </view>
    <button class="btn-primary result-btn" bindtap="closeResult">确定</button>
  </view>
</view>